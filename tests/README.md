# Lotto Simulator 테스트

이 디렉토리에는 로또 시뮬레이터의 핵심 로직에 대한 유닛 테스트가 포함되어 있습니다.

## 📁 테스트 파일

### `lotto.test.ts`
`src/lib/lotto.ts` 파일의 모든 함수에 대한 포괄적인 테스트

**테스트 대상 함수:**
1. `generateLottoNumbers` - 로또 번호 생성
2. `normalizeAndCompleteLottoNumbers` - 사용자 입력 번호 정규화 및 완성
3. `checkLottoResult` - 당첨 결과 확인

### `checkLottoResult.test.ts`
`checkLottoResult` 함수에 대한 기본 테스트 (레거시)

## 🧪 테스트 실행 방법

### 전체 테스트 실행
```bash
npm test
```

### 특정 테스트만 실행
```bash
# lotto.ts 전체 테스트
npm run test:lotto

# checkLottoResult만 테스트
npm run test:check-result
```

## 📊 테스트 커버리지

### `generateLottoNumbers` (11개 테스트)

#### 기본 로또 번호 생성 (보너스 번호 없음)
- ✅ 6개의 번호 생성
- ✅ 1-45 범위 검증
- ✅ 중복 없음 검증
- ✅ 오름차순 정렬 검증
- ✅ 반복 호출 안정성 테스트 (100회)

#### 보너스 번호 포함 로또 번호 생성
- ✅ 7개의 번호 생성 (메인 6개 + 보너스 1개)
- ✅ 1-45 범위 검증
- ✅ 중복 없음 검증
- ✅ 첫 6개 번호 정렬 검증
- ✅ 보너스 번호 위치 검증

#### 기본값 동작
- ✅ 인자 없이 호출 시 6개 생성

---

### `normalizeAndCompleteLottoNumbers` (16개 테스트)

#### 유효한 입력 처리
- ✅ 6개 입력 시 그대로 반환 (정렬됨)
- ✅ 6개 미만 입력 시 자동 완성
- ✅ 빈 배열 입력 시 6개 생성
- ✅ 1개 입력 시 6개로 완성
- ✅ 중복 번호 자동 제거

#### 정렬 및 중복 제거
- ✅ 오름차순 정렬 보장
- ✅ 중복 없음 보장
- ✅ 1-45 범위 검증

#### 에러 처리
- ✅ 7개 이상 입력 시 에러
- ✅ 8개 입력 시 에러
- ✅ 중복 포함 7개 입력 시 에러

#### 엣지 케이스
- ✅ 최소값(1)과 최대값(45) 조합
- ✅ 연속된 번호 입력
- ✅ 반복 호출 시 입력 번호 유지 (50회)

---

### `checkLottoResult` (30개 테스트)

#### 입력 검증
- ✅ 사용자 번호 6개 검증
- ✅ 당첨 번호 7개 검증

#### 1등 당첨 (6개 모두 일치)
- ✅ 메인 번호 6개 일치
- ✅ 번호 순서 무관
- ✅ 보너스 번호 무관

#### 2등 당첨 (5개 + 보너스)
- ✅ 5개 일치 + 보너스 일치
- ✅ 다양한 조합 테스트
- ✅ 보너스 불일치 시 2등 아님

#### 3등 당첨 (5개 일치, 보너스 불일치)
- ✅ 5개 일치 + 보너스 불일치
- ✅ matchedNumbers에 보너스 미포함 검증

#### 4등 당첨 (4개 일치)
- ✅ 4개 일치
- ✅ 보너스 있어도 4등 유지
- ✅ 다양한 조합 테스트

#### 5등 당첨 (3개 일치)
- ✅ 3개 일치
- ✅ 보너스 있어도 5등 유지
- ✅ 최소 당첨 케이스

#### 낙첨 (2개 이하 일치)
- ✅ 0개 일치
- ✅ 1개 일치
- ✅ 2개 일치
- ✅ 보너스만 일치

#### matchedNumbers 검증
- ✅ 일치 번호 정렬 검증
- ✅ 보너스 번호 포함 검증
- ✅ 불일치 번호 미포함 검증

#### 엣지 케이스
- ✅ 최소값 조합
- ✅ 최대값 조합
- ✅ 연속/분산 번호 조합

#### 실제 시나리오
- ✅ 실제 로또 1등 시뮬레이션
- ✅ 실제 로또 2등 시뮬레이션
- ✅ 아쉬운 3등 케이스

---

### 통합 테스트 (3개 테스트)

- ✅ 번호 생성 → 완성 → 결과 확인 워크플로우
- ✅ 여러 티켓 동시 검증
- ✅ **대량 시뮬레이션 (1000회)**
  - 통계적 검증: 대부분 낙첨 확인
  - 모든 등수 합계 검증

## 📈 테스트 통계

```
총 테스트: 63개
통과: 63개
실패: 0개
테스트 스위트: 22개
실행 시간: ~70ms
```

## 🔧 테스트 구성

### TypeScript 설정
- 설정 파일: `tsconfig.test.json`
- 컴파일 출력: `.test-build/` 디렉토리

### Node.js 테스트 러너
- Node.js 내장 테스트 러너 사용 (`node:test`)
- 별도의 테스트 프레임워크 불필요

## 📝 테스트 작성 가이드

### 새로운 테스트 추가

1. `tests/` 디렉토리에 `*.test.ts` 파일 생성
2. Node.js 테스트 API 임포트:
```typescript
import { describe, it } from 'node:test'
import { strict as assert } from 'node:assert'
```

3. 테스트할 함수 임포트 (`.js` 확장자 사용):
```typescript
import { yourFunction } from '../src/lib/your-file.js'
```

4. 테스트 작성:
```typescript
describe('yourFunction', () => {
  it('should do something', () => {
    const result = yourFunction(input)
    assert.equal(result, expected)
  })
})
```

### 테스트 실행
```bash
npm test
```

## 🎯 테스트 철학

1. **포괄성**: 모든 엣지 케이스 커버
2. **명확성**: 테스트 이름만으로도 의도 파악 가능
3. **독립성**: 각 테스트는 독립적으로 실행 가능
4. **실용성**: 실제 사용 시나리오 포함
5. **성능**: 대량 시뮬레이션으로 안정성 검증

## 🐛 테스트 실패 시

1. 에러 메시지 확인
2. 해당 테스트 케이스 분석
3. 함수 구현 또는 테스트 수정
4. 재실행하여 검증

## 📌 참고사항

- 테스트는 빌드 시 자동으로 TypeScript로 컴파일됩니다
- `.test-build/` 디렉토리는 `.gitignore`에 포함되어야 합니다
- 테스트 파일에서 임포트 시 `.js` 확장자를 사용해야 합니다 (TypeScript ESM 설정)
